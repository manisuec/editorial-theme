<header role="banner">
    <div class="container">
        <nav role="navigation" aria-label="Main navigation">
            <a href="{{ .Site.BaseURL }}" class="logo">{{ .Site.Title }}</a>
            <button
                type="button"
                class="mobile-menu-toggle"
                id="menuToggle"
                aria-label="Toggle menu"
                aria-expanded="false"
                aria-controls="navMenu"
            >
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu" id="navMenu" role="menubar">
                {{ $currentPage := . }}
                {{ range .Site.Menus.main }}
                <li role="none">
                    <a href="{{ .URL | relURL }}"
                       class="nav-item"
                       role="menuitem"
                       {{ if or (eq $currentPage.RelPermalink .URL) (hasPrefix $currentPage.RelPermalink .URL) }}
                       aria-current="page"
                       {{ end }}
                    >{{ .Name }}</a>
                </li>
                {{ end }}
            </ul>
        </nav>
    </div>
</header>

<script>
(function() {
    const menuToggle = document.getElementById('menuToggle');
    const navMenu = document.getElementById('navMenu');

    function toggleMobileMenu() {
        const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
        menuToggle.setAttribute('aria-expanded', !isExpanded);
        menuToggle.classList.toggle('active');
        navMenu.classList.toggle('active');
        document.body.style.overflow = !isExpanded ? 'hidden' : '';
    }

    function closeMobileMenu() {
        menuToggle.setAttribute('aria-expanded', 'false');
        menuToggle.classList.remove('active');
        navMenu.classList.remove('active');
        document.body.style.overflow = '';
    }

    menuToggle.addEventListener('click', toggleMobileMenu);

    // Close menu when clicking nav items on mobile
    navMenu.querySelectorAll('.nav-item').forEach(function(item) {
        item.addEventListener('click', closeMobileMenu);
    });

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
        if (navMenu.classList.contains('active') &&
            !navMenu.contains(event.target) &&
            !menuToggle.contains(event.target)) {
            closeMobileMenu();
        }
    });

    // Close menu on escape key
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeMobileMenu();
            menuToggle.focus();
        }
    });
})();
</script>
